(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"+3VT":function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var i=n("fXoL"),c=n("8MG2"),r=n("ws30"),o=n("rGdz"),l=n("3Pt+"),s=n("/qmH"),a=n("yvwu"),b=n("ofXK");function u(t,e){if(1&t&&(i.Pb(0),i.Rb(1,"clr-alert",14),i.Rb(2,"clr-alert-item"),i.Mb(3,"span",15),i.Rb(4,"div",16),i.Rb(5,"a",17),i.Rb(6,"button",18),i.Dc(7,"ISSUE"),i.Qb(),i.Qb(),i.Qb(),i.Qb(),i.Qb(),i.Ob()),2&t){const t=i.bc();i.zb(1),i.hc("clrAlertType","danger")("clrAlertAppLevel",!0),i.zb(2),i.hc("innerHTML",t.errorMessage,i.sc)}}const d=function(){return{theme:"vs-dark",language:"sql"}},p=function(){return{bottom:!0}};let h=(()=>{class t{constructor(t,e){this.exerciseService=t,this.queryHistory=e,this.result=new i.n,this.sqlChange=new i.n,this.addExplain=!1,this.addExplainChange=new i.n,this.enableSafeModeTrigger=!1,this.safeMode=!0,this.safeModeChange=new i.n,this.btnState=c.F.DEFAULT,this.editorHeight="95%"}handleKeypress(t){("F5"===t.code||"Enter"===t.code&&t.ctrlKey)&&(t.preventDefault(),this.onExecute())}ngOnInit(){this.defaultSql=this.sql}onExecute(){this.errorMessage=null,this.btnState=c.F.LOADING,this.exerciseService.executeSql(this.sql,this.addExplain?"text":null,!this.safeMode).then(t=>{this.result.emit(t),this.queryHistory.storeQuery(this.sql,t),this.btnState=c.F.SUCCESS}).catch(t=>{this.btnState=c.F.ERROR,0===t.status&&(this.errorMessage="The hydenv backend is offline or unreachable. Used URL: "+t.url)})}onChange(t){this.sql=t}onReset(){this.sql=this.defaultSql}onResize(t){console.log(t),this.editorHeight=t.rectangle.height+"px",window.dispatchEvent(new Event("resize"))}}return t.\u0275fac=function(e){return new(e||t)(i.Lb(r.a),i.Lb(o.a))},t.\u0275cmp=i.Fb({type:t,selectors:[["app-sql-input"]],hostBindings:function(t,e){1&t&&i.Zb("keydown",(function(t){return e.handleKeypress(t)}),!1,i.qc)},inputs:{sql:"sql",addExplain:"addExplain",enableSafeModeTrigger:"enableSafeModeTrigger",safeMode:"safeMode"},outputs:{result:"result",sqlChange:"sqlChange",addExplainChange:"addExplainChange",safeModeChange:"safeModeChange"},decls:29,vars:15,consts:[[1,"clr-row"],[1,"clr-col-4"],["type","checkbox","clrToggle","",3,"ngModel","ngModelChange"],[1,"tooltip","tooltip-md","tooltip-top-right"],["type","checkbox","clrToggle","",3,"ngModel","disabled","ngModelChange"],[1,"tooltip-content"],[1,"btn","btn-flat","btn-sm",2,"float","right",3,"disabled","click"],[1,"clr-col-12",2,"height","70vh"],["mwlResizable","",1,"resize-container",3,"enableGhostResize","resizing"],[2,"height","100%",3,"options","ngModel","ngModelChange"],["mwlResizeHandle","",1,"resize",3,"resizeEdges"],[1,"clr-col-12"],[4,"ngIf"],[1,"btn","btn-outline-success","btn-block",3,"clrLoading","click"],[3,"clrAlertType","clrAlertAppLevel"],[1,"alert-text",3,"innerHTML"],[1,"alert-actions"],["href","https://github.com/data-hydenv/hydenv-database/issues/new?labels=bug,exercise-js&assignees=mmaelicke","target","_blank"],[1,"btn","alert-action","btn-sm"]],template:function(t,e){1&t&&(i.Rb(0,"div",0),i.Rb(1,"div",1),i.Rb(2,"clr-toggle-container"),i.Rb(3,"clr-toggle-wrapper"),i.Rb(4,"input",2),i.Zb("ngModelChange",(function(t){return e.addExplain=t})),i.Qb(),i.Rb(5,"label"),i.Dc(6,"Explain results"),i.Qb(),i.Qb(),i.Qb(),i.Qb(),i.Rb(7,"div",1),i.Rb(8,"clr-toggle-container"),i.Rb(9,"clr-toggle-wrapper",3),i.Rb(10,"input",4),i.Zb("ngModelChange",(function(t){return e.safeMode=t})),i.Qb(),i.Rb(11,"label"),i.Dc(12,"Safe mode: "),i.Rb(13,"code"),i.Dc(14),i.Qb(),i.Qb(),i.Rb(15,"span",5),i.Dc(16,"In safe mode, only single SELECT queries are allowed."),i.Qb(),i.Qb(),i.Qb(),i.Qb(),i.Rb(17,"div",1),i.Rb(18,"button",6),i.Zb("click",(function(){return e.onReset()})),i.Dc(19,"RESET"),i.Qb(),i.Qb(),i.Qb(),i.Rb(20,"div",0),i.Rb(21,"div",7),i.Rb(22,"div",8),i.Zb("resizing",(function(t){return e.onResize(t)})),i.Rb(23,"ngx-monaco-editor",9),i.Zb("ngModelChange",(function(t){return e.onChange(t)})),i.Qb(),i.Mb(24,"div",10),i.Qb(),i.Qb(),i.Rb(25,"div",11),i.Bc(26,u,8,3,"ng-container",12),i.Rb(27,"button",13),i.Zb("click",(function(){return e.onExecute()})),i.Dc(28,"Execute"),i.Qb(),i.Qb(),i.Qb()),2&t&&(i.zb(4),i.hc("ngModel",e.addExplain),i.zb(6),i.hc("ngModel",e.safeMode)("disabled",!e.enableSafeModeTrigger),i.zb(4),i.Ec(e.safeMode?"on":"off"),i.zb(4),i.hc("disabled",e.sql==e.defaultSql),i.zb(4),i.yc("height",e.editorHeight),i.hc("enableGhostResize",!0),i.zb(1),i.hc("options",i.kc(13,d))("ngModel",e.sql),i.zb(1),i.hc("resizeEdges",i.kc(14,p)),i.zb(2),i.hc("ngIf",e.errorMessage),i.zb(1),i.hc("clrLoading",e.btnState))},directives:[c.f,c.g,l.a,c.e,l.j,l.l,c.C,s.a,a.a,s.c,b.o,c.E,c.D,c.b,c.c,c.d],styles:["div.clr-row[_ngcontent-%COMP%]{margin-top:.6rem}mwlResizable[_ngcontent-%COMP%]{box-sizing:border-box}.resize-container[_ngcontent-%COMP%]{min-height:350px;height:90%;max-height:95%;margin-bottom:1rem}.resize-container[_ngcontent-%COMP%]   .resize[_ngcontent-%COMP%]{height:7px;width:100%;cursor:row-resize;background-color:#243944;transition-duration:.1s;z-index:999}.resize-container[_ngcontent-%COMP%]   .resize[_ngcontent-%COMP%]:hover{background-color:#69a0be;transition-delay:.1s}"]}),t})()},Mkpm:function(t,e){t.exports=c,t.exports.parse=c,t.exports.stringify=function t(e){function n(t){return t.join(" ")}function i(t){return t.map(n).join(", ")}function c(t){return t.map(i).map(r).join(", ")}function r(t){return"("+t+")"}switch("Feature"===e.type&&(e=e.geometry),e.type){case"Point":return"POINT ("+n(e.coordinates)+")";case"LineString":return"LINESTRING ("+i(e.coordinates)+")";case"Polygon":return"POLYGON ("+c(e.coordinates)+")";case"MultiPoint":return"MULTIPOINT ("+i(e.coordinates)+")";case"MultiPolygon":return"MULTIPOLYGON ("+e.coordinates.map(c).map(r).join(", ")+")";case"MultiLineString":return"MULTILINESTRING ("+c(e.coordinates)+")";case"GeometryCollection":return"GEOMETRYCOLLECTION ("+e.geometries.map(t).join(", ")+")";default:throw new Error("stringify requires a valid GeoJSON Feature or geometry object as input")}};var n=/[-+]?([0-9]*\.[0-9]+|[0-9]+)([eE][-+]?[0-9]+)?/,i=new RegExp("^"+n.source+"(\\s"+n.source+"){1,}");function c(t){var e,n=t.split(";"),c=n.pop(),r=(n.shift()||"").split("=").pop(),o=0;function l(t){var e=c.substring(o).match(t);return e?(o+=e[0].length,e[0]):null}function s(){l(/^\s*/)}function a(){s();for(var t,e=0,n=[],c=[n],r=n;t=l(/^(\()/)||l(/^(\))/)||l(/^(,)/)||l(i);){if("("===t)c.push(r),c[c.length-1].push(r=[]),e++;else if(")"===t){if(0===r.length)return null;if(!(r=c.pop()))return null;if(0==--e)break}else if(","===t)c[c.length-1].push(r=[]);else{if(t.split(/\s/g).some(isNaN))return null;Array.prototype.push.apply(r,t.split(/\s/g).map(parseFloat))}s()}return 0!==e?null:n}function b(){for(var t,e,n=[];e=l(i)||l(/^(,)/);)","===e?(n.push(t),t=[]):e.split(/\s/g).some(isNaN)||(t||(t=[]),Array.prototype.push.apply(t,e.split(/\s/g).map(parseFloat))),s();return t?(n.push(t),n.length?n:null):null}return(e=function t(){return function(){if(!l(/^(point(\sz)?)/i))return null;if(s(),!l(/^(\()/))return null;var t=b();return t?(s(),l(/^(\))/)?{type:"Point",coordinates:t[0]}:null):null}()||function(){if(!l(/^(linestring(\sz)?)/i))return null;if(s(),!l(/^(\()/))return null;var t=b();return t&&l(/^(\))/)?{type:"LineString",coordinates:t}:null}()||function(){if(!l(/^(polygon(\sz)?)/i))return null;s();var t=a();return t?{type:"Polygon",coordinates:t}:null}()||function(){if(!l(/^(multipoint)/i))return null;s();var t=c.substring(c.indexOf("(")+1,c.length-1).replace(/\(/g,"").replace(/\)/g,"");c="MULTIPOINT ("+t+")";var e=a();return e?(s(),{type:"MultiPoint",coordinates:e}):null}()||function(){if(!l(/^(multilinestring)/i))return null;s();var t=a();return t?(s(),{type:"MultiLineString",coordinates:t}):null}()||function(){if(!l(/^(multipolygon)/i))return null;s();var t=a();return t?{type:"MultiPolygon",coordinates:t}:null}()||function(){var e,n=[];if(!l(/^(geometrycollection)/i))return null;if(s(),!l(/^(\()/))return null;for(;e=t();)n.push(e),s(),l(/^(,)/),s();return l(/^(\))/)?{type:"GeometryCollection",geometries:n}:null}()}())&&r.match(/\d+/)&&(e.crs={type:"name",properties:{name:"urn:ogc:def:crs:EPSG::"+r}}),e}},"SS/w":function(t,e,n){"use strict";n.d(e,"a",(function(){return H}));var i=n("fXoL"),c=n("8MG2"),r=n("ofXK"),o=n("LvDl"),l=n("Mkpm"),s=n("3Pt+"),a=n("u3+B"),b=n("R9Cn");function u(t,e){1&t&&i.Mb(0,"clr-spinner")}const d=function(){return{position:"relative",width:"100%",height:"450px"}};function p(t,e){if(1&t&&(i.Pb(0),i.Mb(1,"plotly-plot",21),i.Ob()),2&t){const t=i.bc(2);i.zb(1),i.xc(i.kc(5,d)),i.hc("data",t.axes)("layout",t.layout)("useResizeHandler",!0)}}function h(t,e){1&t&&(i.Rb(0,"div",22),i.Rb(1,"i"),i.Dc(2,"First select a plot type and specify the axes"),i.Qb(),i.Qb())}function g(t,e){if(1&t&&(i.Rb(0,"option",23),i.Dc(1),i.Qb()),2&t){const t=e.$implicit;i.hc("value",t),i.zb(1),i.Ec(t)}}function f(t,e){1&t&&(i.Rb(0,"label"),i.Dc(1,"x-axis attribute"),i.Qb())}function m(t,e){1&t&&(i.Rb(0,"label"),i.Dc(1,"Geometry attribute"),i.Qb())}const y=function(t){return[t]};function R(t,e){if(1&t&&(i.Rb(0,"option",23),i.Dc(1),i.Qb()),2&t){const t=e.$implicit;i.hc("value",i.lc(2,y,t)),i.zb(1),i.Ec(t)}}function x(t,e){if(1&t){const t=i.Sb();i.Rb(0,"clr-select-container"),i.Bc(1,f,2,0,"label",11),i.Bc(2,m,2,0,"label",11),i.Rb(3,"select",24),i.Zb("ngModelChange",(function(e){return i.rc(t),i.bc(2).selectedXAttribute=e}))("change",(function(){return i.rc(t),i.bc(2).onXAxisChanged()})),i.Bc(4,R,2,4,"option",10),i.Qb(),i.Qb()}if(2&t){const t=i.bc(2);i.zb(1),i.hc("ngIf","map"!==t.selectedPlotType),i.zb(1),i.hc("ngIf","map"===t.selectedPlotType),i.zb(1),i.hc("ngModel",t.selectedXAttribute),i.zb(1),i.hc("ngForOf",t.xAxisAttributeOptions)}}function Q(t,e){1&t&&(i.Rb(0,"label"),i.Dc(1,"y-axis attributes"),i.Qb())}function z(t,e){1&t&&(i.Rb(0,"label"),i.Dc(1,"property"),i.Qb())}function M(t,e){if(1&t&&(i.Rb(0,"option",23),i.Dc(1),i.Qb()),2&t){const t=e.$implicit;i.hc("value",i.lc(2,y,t)),i.zb(1),i.Ec(t)}}function A(t,e){if(1&t){const t=i.Sb();i.Rb(0,"clr-select-container"),i.Bc(1,Q,2,0,"label",11),i.Bc(2,z,2,0,"label",11),i.Rb(3,"select",25),i.Zb("ngModelChange",(function(e){return i.rc(t),i.bc(2).selectedYAttribute=e})),i.Bc(4,M,2,4,"option",10),i.Qb(),i.Qb()}if(2&t){const t=i.bc(2);i.zb(1),i.hc("ngIf","map"!==t.selectedPlotType),i.zb(1),i.hc("ngIf","map"===t.selectedPlotType),i.zb(1),i.hc("ngModel",t.selectedYAttribute),i.zb(1),i.hc("ngForOf",t.yAxisAttributeOptions)}}function D(t,e){if(1&t){const t=i.Sb();i.Rb(0,"button",17),i.Zb("click",(function(){i.rc(t);const n=e.$implicit,c=i.bc(2).$implicit;return i.bc(3).onChangeSizeFromData(c,n)})),i.Dc(1),i.Qb()}if(2&t){const t=e.$implicit;i.zb(1),i.Fc(" ",t," ")}}function O(t,e){if(1&t&&(i.Rb(0,"clr-dropdown"),i.Rb(1,"button",14),i.Rb(2,"clr-icon",32),i.Dc(3,"SIZE"),i.Qb(),i.Qb(),i.Rb(4,"clr-dropdown-menu",16),i.Bc(5,D,2,1,"button",33),i.Qb(),i.Qb()),2&t){const t=i.bc(4);i.zb(5),i.hc("ngForOf",t.xAxisAttributeOptions)}}const T=function(){return["scatter","map"]};function v(t,e){if(1&t){const t=i.Sb();i.Rb(0,"li",28),i.Rb(1,"div",29),i.Rb(2,"span"),i.Dc(3),i.Qb(),i.Rb(4,"div"),i.Bc(5,O,6,1,"clr-dropdown",11),i.Rb(6,"clr-icon",30),i.Zb("colorPickerChange",(function(n){return i.rc(t),e.$implicit.color=n}))("colorPickerChange",(function(){i.rc(t);const n=e.index;return i.bc(3).onColorChange(n)})),i.Qb(),i.Rb(7,"clr-icon",31),i.Zb("click",(function(){i.rc(t);const n=e.index;return i.bc(3).onRemoveAxis(n)})),i.Qb(),i.Qb(),i.Qb(),i.Qb()}if(2&t){const t=e.$implicit,n=i.bc(3);i.zb(2),i.yc("color",t.color),i.zb(1),i.Ec(t.name),i.zb(2),i.hc("ngIf",i.kc(7,T).includes(n.selectedPlotType)),i.zb(1),i.yc("color",t.color),i.hc("colorPicker",t.color)}}function w(t,e){if(1&t&&(i.Rb(0,"div",6),i.Rb(1,"div",7),i.Dc(2,"Datasets"),i.Qb(),i.Rb(3,"ul",26),i.Bc(4,v,8,8,"li",27),i.Qb(),i.Qb()),2&t){const t=i.bc(2);i.zb(4),i.hc("ngForOf",t.axesLabel)}}function C(t,e){if(1&t){const t=i.Sb();i.Rb(0,"div",2),i.Rb(1,"div",3),i.Bc(2,p,2,6,"ng-container",0),i.Bc(3,h,3,0,"ng-template",null,4,i.Cc),i.Qb(),i.Rb(5,"div",5),i.Rb(6,"div",6),i.Rb(7,"div",7),i.Dc(8,"Add Data"),i.Qb(),i.Rb(9,"div",8),i.Rb(10,"clr-select-container"),i.Rb(11,"label"),i.Dc(12,"Plot type"),i.Qb(),i.Rb(13,"select",9),i.Zb("ngModelChange",(function(e){return i.rc(t),i.bc().selectedPlotType=e}))("change",(function(){return i.rc(t),i.bc().onPlotTypeChanged()})),i.Bc(14,g,2,2,"option",10),i.Qb(),i.Qb(),i.Bc(15,x,5,4,"clr-select-container",11),i.Bc(16,A,5,4,"clr-select-container",11),i.Qb(),i.Rb(17,"div",12),i.Rb(18,"button",13),i.Zb("click",(function(){return i.rc(t),i.bc().onAddYAxis()})),i.Dc(19," Add "),i.Qb(),i.Rb(20,"clr-dropdown"),i.Rb(21,"button",14),i.Mb(22,"clr-icon",15),i.Dc(23," Options "),i.Qb(),i.Rb(24,"clr-dropdown-menu",16),i.Rb(25,"button",17),i.Zb("click",(function(){i.rc(t);const e=i.bc();return e.layout.showlegend=!e.layout.showlegend})),i.Dc(26),i.Qb(),i.Rb(27,"clr-dropdown"),i.Rb(28,"button",18),i.Dc(29,"Map Style"),i.Qb(),i.Rb(30,"clr-dropdown-menu",19),i.Rb(31,"button",17),i.Zb("click",(function(){return i.rc(t),i.bc().onChangeMapStyle("carto-darkmatter")})),i.Dc(32,"dark"),i.Qb(),i.Rb(33,"button",17),i.Zb("click",(function(){return i.rc(t),i.bc().onChangeMapStyle("carto-positron")})),i.Dc(34,"light"),i.Qb(),i.Rb(35,"button",17),i.Zb("click",(function(){return i.rc(t),i.bc().onChangeMapStyle("open-street-map")})),i.Dc(36,"OSM"),i.Qb(),i.Rb(37,"button",17),i.Zb("click",(function(){return i.rc(t),i.bc().onChangeMapStyle("stamen-terrain")})),i.Dc(38,"Terrain"),i.Qb(),i.Qb(),i.Qb(),i.Rb(39,"clr-dropdown"),i.Rb(40,"button",18),i.Dc(41,"Bar Type"),i.Qb(),i.Rb(42,"clr-dropdown-menu",19),i.Rb(43,"button",17),i.Zb("click",(function(){return i.rc(t),i.bc().layout.barmode="group"})),i.Dc(44,"single"),i.Qb(),i.Rb(45,"button",17),i.Zb("click",(function(){return i.rc(t),i.bc().layout.barmode="stack"})),i.Dc(46,"stacked"),i.Qb(),i.Rb(47,"button",17),i.Zb("click",(function(){return i.rc(t),i.bc().layout.barmode="relative"})),i.Dc(48,"relative"),i.Qb(),i.Qb(),i.Qb(),i.Qb(),i.Qb(),i.Qb(),i.Qb(),i.Bc(49,w,5,1,"div",20),i.Qb(),i.Qb()}if(2&t){const t=i.nc(4),e=i.bc();i.zb(2),i.hc("ngIf",e.axes.length>0)("ngIfElse",t),i.zb(11),i.hc("ngModel",e.selectedPlotType),i.zb(1),i.hc("ngForOf",e.plotTypes),i.zb(1),i.hc("ngIf",e.selectedPlotType),i.zb(1),i.hc("ngIf",e.selectedPlotType&&e.selectedXAttribute),i.zb(2),i.hc("disabled","map"!==e.selectedPlotType&&!e.selectedYAttribute),i.zb(8),i.Fc(" ",e.layout.showlegend?"hide":"show"," legend "),i.zb(2),i.hc("disabled","map"!==e.selectedPlotType),i.zb(12),i.hc("disabled","bar"!==e.selectedPlotType),i.zb(9),i.hc("ngIf",e.axes.length>0)}}function k(t){return t&&"[object Date]"===Object.prototype.toString.call(t)&&!isNaN(t)}const P={line:"scatter",scatter:"scatter",bar:"bar",histogram:"bar"},E={line:"lines+markers",scatter:"markers"};let I=(()=>{class t{constructor(){this.attributeNames=[],this.allAttributes=[],this.axesLabel=[],this.axes=[],this.layout={autosize:!0,plot_bgcolor:"#1A2A32",paper_bgcolor:"#1A2A32",barmode:"stack",showlegend:!1,font:{size:18,color:"#fff"},mapbox:{style:"carto-darkmatter",pitch:25}},this.plotTypes=[],this.xAxisAttributeOptions=[],this.yAxisAttributeOptions=[],this.loading=!0}set data(t){this.rawData=t,this.extractAttributes()}ngOnInit(){}onPlotTypeChanged(){this.axes=[],"line"!==this.selectedPlotType&&"bar"!==this.selectedPlotType||(this.xAxisAttributeOptions=this.allAttributes.filter(t=>["numeric","datetime","text"].includes(t.type)).map(t=>t.name),this.yAxisAttributeOptions=this.allAttributes.filter(t=>"numeric"===t.type).map(t=>t.name)),"scatter"===this.selectedPlotType&&(this.xAxisAttributeOptions=this.allAttributes.filter(t=>"numeric"===t.type).map(t=>t.name),this.yAxisAttributeOptions=this.allAttributes.filter(t=>"numeric"===t.type).map(t=>t.name)),"map"===this.selectedPlotType?(this.xAxisAttributeOptions=this.allAttributes.filter(t=>["lonLat","linestring","polygon"].includes(t.type)).map(t=>t.name),this.yAxisAttributeOptions=this.allAttributes.filter(t=>"numeric"===t.type).map(t=>t.name),this.layout.margin={t:0,b:0,l:0,r:0}):this.layout.margin=null,this.selectedXAttribute=null,this.selectedYAttribute=null}onColorChange(t){const e=this.axesLabel[t].color;this.axesLabel[t].idx.forEach(t=>{this.axes[t].marker.color=e,this.axes[t].marker.fillcolor&&(this.axes[t].marker.fillcolor=e)})}onChangeSizeFromData(t,e){const n=this.allAttributes.find(t=>t.name===e),i=n?[...n.data]:null;this.axesLabel[t].idx.forEach(t=>{this.axes[t].marker.size=i})}convertMapLayer(t,e){if("lonLat"===t.type){const n={name:e?e.name:t.name,lon:[...t.data.map(t=>t.coordinates[0])],lat:[...t.data.map(t=>t.coordinates[1])],type:"scattermapbox",mode:"lonLat"===t.type?"markers":"lines"};return e&&(n.text=e.data.map(t=>String(t)),Object(o.isNumber)(e.data[0])&&(n.z=[...e.data])),[n]}if("linestring"===t.type){const n=[];return t.data.forEach((i,c)=>{const r={type:"scattermapbox",name:e?e.name:t.name,lon:[...i.coordinates.map(t=>t[0])],lat:[...i.coordinates.map(t=>t[1])],marker:{size:12,color:"cyan"},mode:"lines",z:e&&Object(o.isNumber)(e.data[c])?e.data[c]:null,text:e?e.data[c]:null};n.push(r)}),n}return[{type:"choroplethmapbox",z:e?[...e.data]:[...t.data.map(t=>1)],locations:[...t.data.map((t,e)=>e)],geojson:Object(o.cloneDeep)({type:"FeatureCollection",features:[...t.data.map((t,e)=>({type:"Feature",id:e,geometry:Object.assign({},t)}))]})}]}onXAxisChanged(){const t=this.allAttributes.find(t=>t.name===this.selectedXAttribute);if(t&&"map"!==this.selectedPlotType){const e=this.axes.map(e=>Object.assign(Object.assign({},e),{x:[...t.data]}));this.axes=Object(o.cloneDeep)(e)}}onAddYAxis(){const t=this.allAttributes.find(t=>t.name===this.selectedYAttribute),e=this.allAttributes.find(t=>t.name===this.selectedXAttribute);if("map"===this.selectedPlotType){const n=this.convertMapLayer(e,t),i=this.axes.length-1,c=n.map((t,e)=>i+(e+1));this.axes=[...this.axes,...n],this.axesLabel.push({name:t?t.name:e.name,color:"cyan",idx:[...c]}),console.log(this.axes)}else if(t&&e){const n={x:[...e.data],y:[...t.data],type:P[this.selectedPlotType],mode:E[this.selectedPlotType],name:t.name,marker:{color:"cyan"}};this.axes=[...this.axes,n],this.axesLabel.push({name:t.name,color:"cyan",idx:[this.axes.length-1]})}}onRemoveAxis(t){const e=this.axesLabel[t],n=this.axes.filter((t,n)=>!e.idx.includes(n));this.axes=Object(o.cloneDeep)(n),this.axesLabel.splice(t,1)}getAllowedPlotTypes(){this.plotTypes=[];const t=Object(o.sum)(this.allAttributes.map(t=>"numeric"===t.type?1:0)),e=Object(o.sum)(this.allAttributes.map(t=>"datetime"===t.type?1:0)),n=Object(o.sum)(this.allAttributes.map(t=>"text"===t.type?1:0)),i=Object(o.sum)(this.allAttributes.map(t=>["lonLat","linestring","polygon"].includes(t.type)?1:0));(t>=2||e>=1&&t>=1||n>=1&&t>=1)&&(this.plotTypes.push("line"),this.plotTypes.push("bar")),t>=2&&this.plotTypes.push("scatter"),i>=1&&this.plotTypes.push("map"),this.loading=!1}extractAttributes(){this.loading=!0,this.attributeNames=[],this.allAttributes=[];const t=this.rawData[0];Object.keys(t).forEach(e=>{if(!this.attributeNames.includes(e)){const n=this.inferAttributeType(t,e);if(n){this.attributeNames.push(e);const t={name:e,type:n,data:[]};this.allAttributes.push(Object(o.cloneDeep)(t))}}}),this.allAttributes.forEach(t=>{if("datetime"===t.type)t.data=[...this.rawData.map(e=>new Date(e[t.name]))];else if(["lonLat","linestring","polygon"].includes(t.type)){const e=[...this.rawData.map(e=>l.parse(e[t.name]))];console.log(e),t.data=e}else t.data=[...this.rawData.map(e=>e[t.name])]}),this.getAllowedPlotTypes()}inferAttributeType(t,e){const n=t[e];return"number"==typeof n?"numeric":"string"==typeof n?n.includes("POINT")?"lonLat":n.includes("LINESTRING")?"linestring":n.includes("POLYGON")?"polygon":k(new Date(n))?"datetime":"text":"object"==typeof n&&k(n)?"datetime":null}onChangeMapStyle(t){this.layout=Object.assign(Object.assign({},this.layout),{mapbox:Object.assign(Object.assign({},this.layout.mapbox),{style:t})})}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Fb({type:t,selectors:[["app-result-plot"]],inputs:{data:"data"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["plot",""],[1,"clr-row"],[1,"clr-col-md-9","clr-col-sm-12"],["noPlot",""],[1,"clr-col-md-3","clr-col-sm-12"],[1,"card"],[1,"card-header"],[1,"card-block","select-block"],["clrSelect","","name","plotType",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"card-footer"],[1,"btn","btn-primary","btn-sm",3,"disabled","click"],["clrDropdownTrigger","",1,"btn","btn-link"],["shape","caret","direction","right"],["clrPosition","left"],["clrDropdownItem","",3,"click"],["clrDropdownTrigger","",3,"disabled"],["clrPosition","bottom-left"],["class","card",4,"ngIf"],[3,"data","layout","useResizeHandler"],[2,"width","100%","height","450%","display","flex","flex-direction","column","justify-content","center","text-align","center"],[3,"value"],["clrSelect","","name","xAxis",3,"ngModel","ngModelChange","change"],["clrSelect","","name","yAxis",3,"ngModel","ngModelChange"],[1,"list-group"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"list-group-item"],[2,"display","flex","flex-direction","row","justify-content","space-between"],["shape","color-palette",1,"is-solid",3,"colorPicker","colorPickerChange"],["shape","times",2,"cursor","pointer",3,"click"],["shape","caret","dir","up"],["clrDropdownItem","",3,"click",4,"ngFor","ngForOf"]],template:function(t,e){if(1&t&&(i.Bc(0,u,1,0,"clr-spinner",0),i.Bc(1,C,50,11,"ng-template",null,1,i.Cc)),2&t){const t=i.nc(2);i.hc("ngIf",e.loading)("ngIfElse",t)}},directives:[r.o,c.N,c.M,c.C,s.q,c.L,s.j,s.l,r.n,c.s,c.v,c.x,c.u,c.t,a.a,s.n,s.s,b.a],styles:[""]}),t})();function L(t,e){if(1&t&&(i.Rb(0,"clr-dg-column",6),i.Dc(1),i.Qb()),2&t){const t=e.$implicit;i.hc("clrDgField",t),i.zb(1),i.Ec(t)}}function S(t,e){if(1&t&&(i.Rb(0,"clr-dg-cell"),i.Dc(1),i.Qb()),2&t){const t=e.$implicit,n=i.bc().$implicit;i.zb(1),i.Ec(n[t])}}function F(t,e){if(1&t&&(i.Rb(0,"clr-dg-row"),i.Bc(1,S,2,1,"clr-dg-cell",7),i.Qb()),2&t){const t=i.bc(2);i.zb(1),i.hc("ngForOf",t.resultColumns)}}function j(t,e){if(1&t&&(i.Rb(0,"clr-dg-pagination",8,9),i.Dc(2),i.Qb()),2&t){const t=i.bc(2);i.hc("clrDgTotalItems",t.res.data.length),i.zb(2),i.Gc(" Total: ",t.res.data.length," row",t.res.data.length>0?"s":""," ")}}function B(t,e){if(1&t&&(i.Rb(0,"clr-tab"),i.Rb(1,"button",1),i.Dc(2,"Data"),i.Qb(),i.Rb(3,"clr-tab-content"),i.Rb(4,"clr-datagrid",2),i.Bc(5,L,2,2,"clr-dg-column",3),i.Bc(6,F,2,1,"clr-dg-row",4),i.Rb(7,"clr-dg-footer"),i.Bc(8,j,3,3,"clr-dg-pagination",5),i.Qb(),i.Qb(),i.Qb(),i.Qb()),2&t){const t=i.bc();i.zb(4),i.hc("clrDgLoading",t.loading),i.zb(1),i.hc("ngForOf",t.resultColumns),i.zb(1),i.hc("clrDgItemsOf",t.res.data),i.zb(2),i.hc("ngIf",!t.loading)}}function N(t,e){if(1&t&&(i.Rb(0,"clr-tab"),i.Rb(1,"button",1),i.Dc(2,"Analyse"),i.Qb(),i.Rb(3,"clr-tab-content"),i.Rb(4,"code"),i.Mb(5,"pre",10),i.Qb(),i.Qb(),i.Qb()),2&t){const t=i.bc();i.zb(5),i.hc("innerHTML",t.res.explain,i.sc)}}function q(t,e){if(1&t&&(i.Rb(0,"clr-tab-content"),i.Mb(1,"app-result-plot",12),i.Qb()),2&t){const t=i.bc(2);i.zb(1),i.hc("data",t.res.data)}}function Z(t,e){1&t&&(i.Rb(0,"clr-tab"),i.Rb(1,"button",1),i.Dc(2,"Plot"),i.Qb(),i.Bc(3,q,2,1,"clr-tab-content",11),i.Qb())}function G(t,e){if(1&t&&(i.Rb(0,"clr-tab"),i.Rb(1,"button",1),i.Dc(2,"Performance"),i.Qb(),i.Rb(3,"clr-tab-content"),i.Rb(4,"clr-datagrid"),i.Rb(5,"clr-dg-column"),i.Dc(6,"Measure"),i.Qb(),i.Rb(7,"clr-dg-column"),i.Dc(8,"Value"),i.Qb(),i.Rb(9,"clr-dg-row"),i.Rb(10,"clr-dg-cell"),i.Dc(11,"Execution Time"),i.Qb(),i.Rb(12,"clr-dg-cell"),i.Dc(13),i.Qb(),i.Qb(),i.Rb(14,"clr-dg-row"),i.Rb(15,"clr-dg-cell"),i.Dc(16,"Backend Time"),i.Qb(),i.Rb(17,"clr-dg-cell"),i.Dc(18),i.Qb(),i.Qb(),i.Qb(),i.Qb(),i.Qb()),2&t){const t=i.bc();i.zb(13),i.Ec(t.res.perf.executionTime),i.zb(5),i.Ec(t.res.perf.backendTime)}}let H=(()=>{class t{constructor(){this.loading=!0,this.resultColumns=[]}set result(t){this.loading=!0,this.res=t,this.getResultColumns()}ngOnInit(){}getResultColumns(){this.resultColumns=[],this.res.data.forEach(t=>{Object.keys(t).forEach(t=>{this.resultColumns.includes(t)||this.resultColumns.push(t)}),this.loading=!1})}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Fb({type:t,selectors:[["app-sql-result"]],inputs:{result:"result",explain:"explain"},decls:5,vars:4,consts:[[4,"ngIf"],["clrTabLink",""],[3,"clrDgLoading"],[3,"clrDgField",4,"ngFor","ngForOf"],[4,"clrDgItems","clrDgItemsOf"],[3,"clrDgTotalItems",4,"ngIf"],[3,"clrDgField"],[4,"ngFor","ngForOf"],[3,"clrDgTotalItems"],["pagination",""],[3,"innerHTML"],[4,"clrIfActive"],[3,"data"]],template:function(t,e){1&t&&(i.Rb(0,"clr-tabs"),i.Bc(1,B,9,4,"clr-tab",0),i.Bc(2,N,6,1,"clr-tab",0),i.Bc(3,Z,4,0,"clr-tab",0),i.Bc(4,G,19,2,"clr-tab",0),i.Qb()),2&t&&(i.zb(1),i.hc("ngIf",e.res),i.zb(1),i.hc("ngIf",e.res&&e.res.explain),i.zb(1),i.hc("ngIf",e.res&&e.res.data&&e.res.data.length>1),i.zb(1),i.hc("ngIf",e.res))},directives:[c.R,c.gb,r.o,c.O,c.Q,c.Z,c.P,c.h,c.cb,c.eb,c.Y,c.fb,r.n,c.o,c.n,c.j,c.bb,c.r,c.db,c.i,c.ab,c.q,c.y,I],styles:["pre[_ngcontent-%COMP%]{padding:.6rem}clr-datagrid[_ngcontent-%COMP%]{height:auto!important}"]}),t})()}}]);